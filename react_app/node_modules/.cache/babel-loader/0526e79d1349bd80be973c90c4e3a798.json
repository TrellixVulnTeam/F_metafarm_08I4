{"ast":null,"code":"import _slicedToArray from\"C:/Users/klodv/OneDrive/\\uBC14\\uD0D5 \\uD654\\uBA74/react-p/ReactDRF/react_app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";/* eslint-disable */import React,{useState,useRef,useEffect}from'react';// import './RestAPI.css';\nimport axios from'axios';// fetch 보단 axios를 사용하자\nimport Cropper from'react-cropper';import'cropperjs/dist/cropper.css';// react-image-crop 별로임 canvas를 써야되는데 코드도 길고 레퍼런스가 너무 옛날꺼임\nimport{FileUploader}from\"react-drag-drop-files\";import\"../styles/style.scss\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function RestAPI(){// const [text, setText] = useState('test');\n// const [Img, setImg] = useState('');\n// const [title , setTitle] = useState(\"\");\n// const [image , setImage] = useState('');\nvar cropperRef=useRef(null);// 유저가 첨부한 이미지\n// const [inputImage, setInputImage] = useState(null);\n// 유저가 선택한 영역만큼 크롭된 이미지\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),croppedImage=_useState2[0],setCroppedImage=_useState2[1];var onCrop=function onCrop(){var imageElement=cropperRef===null||cropperRef===void 0?void 0:cropperRef.current;var cropper=imageElement===null||imageElement===void 0?void 0:imageElement.cropper;setCroppedImage(cropper.getCroppedCanvas().toDataURL());};var dataURLtoFile=function dataURLtoFile(){var dataurl={croppedImage:croppedImage}['croppedImage'];// console.log(dataurl)\nvar arr=dataurl.split(','),mime=arr[0].match(/:(.*?);/)[1],bstr=atob(arr[1]),n=bstr.length,u8arr=new Uint8Array(n);while(n--){u8arr[n]=bstr.charCodeAt(n);}var file=new File([u8arr],'base64_to_img.jpg',{type:mime});console.log(file);// console.log(typeof(file))\n// console.log(file.name)\n// console.log(typeof(file.name))\nvar fd=new FormData();fd.append('image',file);fd.append('title',file.name);axios.post('http://127.0.0.1:8000/api/image/',fd,{headers:{'Content-Type':'multipart/form-data'}}).then(function(response){console.log(response);response['status']===200||201?console.log('ITS 200 OR 201'):console.log('ITS not working!');}).catch(function(error){console.log(error);});};var fileTypes=[\"JPEG\",\"PNG\",\"GIF\",\"JPG\"];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var handleChange=function handleChange(file){//   const handleChange = (e) => {\nsetFile(URL.createObjectURL(file[0]));// setFile(URL.createObjectURL(e.target.files[0]));\nconsole.log(file[0]);console.log(typeof file);};var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),ScrollY=_useState6[0],setScrollY=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),BtnStatus=_useState8[0],setBtnStatus=_useState8[1];// 버튼 상태\nvar handleFollow=function handleFollow(){setScrollY(window.pageYOffset);if(ScrollY>100){// 100 이상이면 버튼이 보이게\nsetBtnStatus(true);}else{// 100 이하면 버튼이 사라지게\nsetBtnStatus(false);}};var handleTop=function handleTop(){// 클릭하면 스크롤이 위로 올라가는 함수\nwindow.scrollTo({top:0,behavior:\"smooth\"});setScrollY(0);// ScrollY 의 값을 초기화\nsetBtnStatus(false);// BtnStatus의 값을 false로 바꿈 => 버튼 숨김\n};useEffect(function(){var watch=function watch(){window.addEventListener('scroll',handleFollow);};watch();return function(){window.removeEventListener('scroll',handleFollow);};});return/*#__PURE__*/_jsxs(\"div\",{className:\"wrap\",children:[/*#__PURE__*/_jsx(\"button\",{className:BtnStatus?\"topBtn active\":\"topBtn\"// 버튼 노출 여부\n,onClick:handleTop// 버튼 클릭시 함수 호출\n,children:\"TOP\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uC790\\uB974\\uACE0 \\uC2F6\\uC740 \\uC601\\uC5ED\\uC744 \\uC120\\uD0DD\\uD574 \\uC8FC\\uC138\\uC694.\"}),/*#__PURE__*/_jsx(FileUploader,{multiple:true,handleChange:handleChange// handleChange={(e)=>{setFile(URL.createObjectURL(e.target.files[0]))}}\n,name:\"file\",types:fileTypes}),/*#__PURE__*/_jsx(\"div\",{children:file&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Cropper,{src:file// crop={onCrop}\n,ref:cropperRef,style:{height:400,width:\"100%\"},initialAspectRatio:16/9}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){console.log(typeof{croppedImage:croppedImage}['croppedImage']);},children:\"CROP LOG type\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){console.log({croppedImage:croppedImage});},children:\"CROP LOG\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onCrop,children:\"CROP\"})]})})]}),croppedImage&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{src:croppedImage}),/*#__PURE__*/_jsx(\"button\",{onClick:dataURLtoFile,children:\"base64Image to imagefile POST\"})]})]})]});}export default RestAPI;","map":{"version":3,"names":["React","useState","useRef","useEffect","axios","Cropper","FileUploader","RestAPI","cropperRef","croppedImage","setCroppedImage","onCrop","imageElement","current","cropper","getCroppedCanvas","toDataURL","dataURLtoFile","dataurl","arr","split","mime","match","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","file","File","type","console","log","fd","FormData","append","name","post","headers","then","response","catch","error","fileTypes","setFile","handleChange","URL","createObjectURL","ScrollY","setScrollY","BtnStatus","setBtnStatus","handleFollow","window","pageYOffset","handleTop","scrollTo","top","behavior","watch","addEventListener","removeEventListener","height","width"],"sources":["C:/Users/klodv/OneDrive/바탕 화면/react-p/ReactDRF/react_app/src/pages/RestAPI.js"],"sourcesContent":["/* eslint-disable */\r\n\r\nimport React, { useState, useRef, useEffect} from 'react';\r\n// import './RestAPI.css';\r\nimport axios from 'axios'; // fetch 보단 axios를 사용하자\r\nimport Cropper from 'react-cropper';\r\nimport 'cropperjs/dist/cropper.css'; // react-image-crop 별로임 canvas를 써야되는데 코드도 길고 레퍼런스가 너무 옛날꺼임\r\nimport { FileUploader } from \"react-drag-drop-files\";\r\nimport \"../styles/style.scss\"\r\n\r\nfunction RestAPI() {\r\n    // const [text, setText] = useState('test');\r\n    // const [Img, setImg] = useState('');\r\n\r\n    // const [title , setTitle] = useState(\"\");\r\n    // const [image , setImage] = useState('');\r\n    \r\n    const cropperRef = useRef(null);\r\n    // 유저가 첨부한 이미지\r\n    // const [inputImage, setInputImage] = useState(null);\r\n    // 유저가 선택한 영역만큼 크롭된 이미지\r\n    const [croppedImage, setCroppedImage] = useState(null);\r\n\r\n    const onCrop = () => {\r\n        const imageElement = cropperRef?.current;\r\n        const cropper = imageElement?.cropper;\r\n        setCroppedImage(cropper.getCroppedCanvas().toDataURL());\r\n    };  \r\n\r\n    const dataURLtoFile = () => {\r\n        let dataurl = {croppedImage}['croppedImage']\r\n        // console.log(dataurl)\r\n        var arr = dataurl.split(','),\r\n            mime = arr[0].match(/:(.*?);/)[1],\r\n            bstr = atob(arr[1]), \r\n            n = bstr.length, \r\n            u8arr = new Uint8Array(n);\r\n            \r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        \r\n        var file = new File([u8arr], 'base64_to_img.jpg', {type:mime});\r\n        console.log(file)\r\n        // console.log(typeof(file))\r\n        // console.log(file.name)\r\n        // console.log(typeof(file.name))\r\n        const fd = new FormData();\r\n        fd.append('image', file);\r\n        fd.append('title', file.name);\r\n        axios\r\n        .post('http://127.0.0.1:8000/api/image/', fd, {\r\n            headers: {\r\n              'Content-Type': 'multipart/form-data'\r\n            }\r\n        })\r\n        .then(function(response){\r\n            console.log(response);\r\n            response['status'] === 200 || 201 ? console.log('ITS 200 OR 201') : console.log('ITS not working!')\r\n            \r\n        })\r\n        .catch(function(error){\r\n            console.log(error);\r\n        });\r\n    }\r\n\r\n    const fileTypes = [\"JPEG\", \"PNG\", \"GIF\",\"JPG\"];\r\n\r\n\r\n      const [file, setFile] = useState(null);\r\n      const handleChange = (file) => {\r\n    //   const handleChange = (e) => {\r\n        setFile(URL.createObjectURL(file[0]));\r\n        // setFile(URL.createObjectURL(e.target.files[0]));\r\n        console.log(file[0])\r\n        console.log(typeof(file))\r\n\r\n      };\r\n      \r\n      const [ScrollY, setScrollY] = useState(0);\r\n      const [BtnStatus, setBtnStatus] = useState(false); // 버튼 상태\r\n      \r\n      const handleFollow = () => {\r\n        setScrollY(window.pageYOffset);\r\n        if(ScrollY > 100) {\r\n          // 100 이상이면 버튼이 보이게\r\n          setBtnStatus(true);\r\n        } else {\r\n          // 100 이하면 버튼이 사라지게\r\n          setBtnStatus(false);\r\n        }\r\n      }\r\n    \r\n      const handleTop = () => {  // 클릭하면 스크롤이 위로 올라가는 함수\r\n        window.scrollTo({\r\n          top: 0,\r\n          behavior: \"smooth\"\r\n        });\r\n        setScrollY(0);  // ScrollY 의 값을 초기화\r\n        setBtnStatus(false); // BtnStatus의 값을 false로 바꿈 => 버튼 숨김\r\n      }\r\n    \r\n      useEffect(() => {\r\n        const watch = () => {\r\n          window.addEventListener('scroll', handleFollow)\r\n        }\r\n        watch();\r\n        return () => {\r\n          window.removeEventListener('scroll', handleFollow)\r\n        }\r\n      })\r\n\r\n    return (\r\n        <div className='wrap'>\r\n            <button \r\n                className={BtnStatus ? \"topBtn active\" : \"topBtn\"} // 버튼 노출 여부\r\n                onClick={handleTop}  // 버튼 클릭시 함수 호출\r\n                >TOP</button>\r\n            <div>\r\n            <div className=\"App\">\r\n          <h1>자르고 싶은 영역을 선택해 주세요.</h1>\r\n          <FileUploader\r\n            multiple={true}\r\n            handleChange={handleChange}\r\n            // handleChange={(e)=>{setFile(URL.createObjectURL(e.target.files[0]))}}\r\n            name=\"file\"\r\n            types={fileTypes}\r\n          />\r\n\r\n          <div>{file && (\r\n                    <div>\r\n                        <Cropper\r\n                            src={file}\r\n                            // crop={onCrop}\r\n                            ref={cropperRef}\r\n                            style={{ height: 400, width: \"100%\" }}\r\n                            initialAspectRatio={16 / 9}\r\n                        />\r\n                        \r\n                        <button onClick={()=>{console.log(typeof({croppedImage}['croppedImage']))}}>CROP LOG type</button>\r\n                        <button onClick={()=>{console.log({croppedImage})}}>CROP LOG</button>\r\n                        <button onClick={onCrop}>CROP</button>\r\n                        \r\n                    </div>\r\n                )}</div>\r\n        </div>\r\n\r\n                            \r\n                {croppedImage && (\r\n                    <div>\r\n                        <img src={croppedImage} />\r\n                        <button onClick={dataURLtoFile}>base64Image to imagefile POST</button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n            \r\n        </div>\r\n      );\r\n}\r\n\r\nexport default RestAPI;"],"mappings":"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"},"metadata":{},"sourceType":"module"}